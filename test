@else if (row?.ds?.timeline?.some(t => t.shortLabel === 'end'))
  <metabot-bar-timeline
    [treatmentDate]="row?.ds?.treatmentDate"
    [timeline]="row?.ds?.timeline"
    [date]="row?.ds?.treatmentDate">
  </metabot-bar-timeline>

ngOnInit(): void {
  this.timelineRep = this.timeLine1.find(e => e.shortLabel === 'end');

  this.countDay = this.getCountDay();

  if (this.timelineRep?.dayInBetweenDates) {
    this.bufferValue = Math.abs(this.timelineRep.dayInBetweenDates);
  }

  this.value = this.getProgress();

  if (this.isInProgress()) {
    this.backgroundColor = this.countDay > 0 ? 'success-progress' : 'danger-progress';
  }
}

private getCountDay(): number {
  return this.timelineRep?.formattedValueShort?.includes('j')
    ? parseInt(this.timelineRep.formattedValueShort)
    : 0;
}

getDsEndTimeline(row: any): TimeLineV2 | null {
  if (!row?.ds?.timeline) return null;
  return row.ds.timeline.find((t: any) => t.shortLabel === 'end') ?? null;
}

getDsTreatmentDate(row: any): number | null {
  return row?.ds?.treatmentDate ?? null;
}

<ng-container *ngIf="getDsEndTimeline(row) as endTimeline">
  <metabot-bar-timeline
    [treatmentDate]="getDsTreatmentDate(row)"
    [timeline]="[endTimeline]"
    [date]="row?.ds?.treatmentDelay">
  </metabot-bar-timeline>
</ng-container>
