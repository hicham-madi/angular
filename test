public onCdkScroll(): void {
  const viewport = this.cdkVirtualScroll;
  const { end } = viewport.getRenderedRange();     // index affiché à l’écran
  const total = viewport.getDataLength();          // nb total d’éléments
  const pageSize = 20;                             // adapte si variable
  const currentPageEnd = (Math.floor(total / pageSize) - (this.hasPendingPage ? 1 : 0)) * pageSize;

  // ⚠️ N'appeler que si on atteint la fin de la dernière page récupérée
  if (end >= currentPageEnd + pageSize) {
    this.scrolled.emit();
  }
}

<metabot-solicitings-table
  ...
  [hasPendingPage]="!allPagesLoaded"
  (scrolled)="onScroll()"
/>
