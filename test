public List<Ticket> findMatchingTickets(String envId, String customerId, String edsId) {
    Predicate<?, ?> predicate = Predicates.or(
        // Groupe de discussion
        Predicates.equal("discussionGroup.users._id", customerId),

        // Approbation
        Predicates.and(
            Predicates.equal("approval.manager", customerId),
            Predicates.or(
                Predicates.equal("status", "APPROVAL_PENDING"),
                Predicates.and(
                    Predicates.equal("status", "APPROVAL_REFUSED"),
                    Predicates.equal("approval.discussion", true)
                )
            )
        ),

        // Sollicitations classiques
        Predicates.and(
            Predicates.in("claimType.code", "D", "DC", "RC"),
            Predicates.in("status", "NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"),
            Predicates.equal("customer.id", customerId)
        ),

        // DS avec sous-conditions complexes
        Predicates.and(
            Predicates.equal("claimType.code", "DS"),
            Predicates.in("status", "NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"),
            Predicates.or(
                Predicates.equal("ds.collabTreatmentDone", false),
                Predicates.and(
                    Predicates.equal("ds.collabTreatmentDone", true),
                    Predicates.equal("readCustomer", false)
                )
            ),
            Predicates.or(
                Predicates.equal("customer.id", customerId),
                Predicates.and(
                    Predicates.equal("customer.eds", true),
                    Predicates.equal("customer.edsId", edsId)
                )
            )
        )
    );

    List<Ticket> allTickets = new ArrayList<>();
    allTickets.addAll(this.filterByViewsTypeAndPredicate(
        envId,
        Arrays.asList(InMemoryViewEnum.ON_GOING, InMemoryViewEnum.TO_PROCESS),
        predicate
    ));

    return allTickets.stream().distinct().toList();
}
