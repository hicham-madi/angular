db.getCollection("tickets_CR882").find({
  $or: [
    // Requêtes D/DC
    {
      $and: [
        { "claimType.code": { $in: ["D", "DC"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        { "customer._id": "OW80700" }
      ]
    },
    {
      $and: [
        { "claimType.code": { $in: ["D", "DC"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        { "customer._id": "OW80700" },
        { "readCustomer": false }
      ]
    },

    // Requêtes RC
    {
      $and: [
        { "claimType.code": { $in: ["RC"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        { "customer._id": "OW80700" }
      ]
    },
    {
      $and: [
        { "claimType.code": { $in: ["RC"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        { "customer._id": "OW80700" },
        { "readCustomer": false }
      ]
    },

    // Approbations
    {
      $and: [
        { "approval.manager": "OW80700" },
        {
          $or: [
            { "status": "APPROVAL_PENDING" },
            {
              $and: [
                { "status": "APPROVAL_REFUSED" },
                { "approval.discussion": true }
              ]
            }
          ]
        }
      ]
    },

    // Groupes de discussion
    { "discussionGroup.users._id": "OW80700" },

    // Groupes de discussion non lus
    {
      discussionGroup: {
        $elemMatch: {
          "users._id": "OW80700",
          "users.ticketRead": false
        }
      }
    },

    // DS en tant que OW80700
    {
      $and: [
        { "claimType.code": { $in: ["DS"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        {
          $or: [
            { "ds.collabTreatmentDone": false },
            { $and: [{ "ds.collabTreatmentDone": true }, { "readCustomer": false }] }
          ]
        },
        {
          $or: [
            { "customer._id": "OW80700" },
            { $and: [{ "customer.eds": true }, { "customer.edsId": "88200-00501" }] }
          ]
        }
      ]
    },

    // DS non lus
    {
      $and: [
        { "readCustomer": false },
        { "claimType.code": { $in: ["DS"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        {
          $or: [
            { "ds.collabTreatmentDone": false },
            { $and: [{ "ds.collabTreatmentDone": true }, { "readCustomer": false }] }
          ]
        },
        {
          $or: [
            { "customer._id": "OW80700" },
            { $and: [{ "customer.eds": true }, { "customer.edsId": "88200-00501" }] }
          ]
        }
      ]
    },

    // DS en retard
    {
      $and: [
        { "ds.treatmentIsLate": true },
        { "claimType.code": { $in: ["DS"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        {
          $or: [
            { "ds.collabTreatmentDone": false },
            { $and: [{ "ds.collabTreatmentDone": true }, { "readCustomer": false }] }
          ]
        },
        {
          $or: [
            { "customer._id": "OW80700" },
            { $and: [{ "customer.eds": true }, { "customer.edsId": "88200-00501" }] }
          ]
        }
      ]
    },

    // DS affectées à l'unité
    {
      $and: [
        { "customer.eds": true },
        { "customer.edsId": "88200-00501" },
        { "claimType.code": { $in: ["DS"] } }
      ]
    }
  ]
})
