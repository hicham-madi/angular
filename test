public static com.hazelcast.query.Predicate<Object, Ticket> readCustomer(String userId, String edsId) {
    return Predicates.and(
        Predicates.equal(CLAIM_TYPE_CODE_FIELD, ClaimTypeCode.DS.toString()),
        Predicates.in(STATUS_FIELD,
            StatusTicket.NEW.toString(),
            StatusTicket.PROCESSING.toString(),
            StatusTicket.PENDING.toString(),
            StatusTicket.APPROVAL_PENDING.toString(),
            StatusTicket.APPROVAL_REFUSED.toString()
        ),
        Predicates.or(
            Predicates.equal(DS_COLLAB_TREATMENT_DONE_FIELD, false),
            Predicates.and(
                Predicates.equal(DS_COLLAB_TREATMENT_DONE_FIELD, true),
                Predicates.equal(READ_CUSTOMER_FIELD, false)
            )
        ),
        Predicates.or(
            Predicates.equal(CUSTOMER_ID_FIELD, userId),
            Predicates.and(
                Predicates.equal(CUSTOMER_EDS_FIELD, true),
                Predicates.equal(CUSTOMER_EDS_ID_FIELD, edsId)
            )
        )
    );
}
db.getCollection("tickets_CR882").find({
  $or: [
    // ðŸ”¹ Mes sollicitations non lues en tant que OW80700
    {
      $and: [
        { "claimType.code": { $in: ["D", "DC", "RC"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        { "customer._id": "OW80700" },
        { "readCustomer": false }
      ]
    },

    // ðŸ”¹ Mes groupes de discussion non lus en tant que manager OW80700
    {
      "discussionGroup.users": {
        $elemMatch: {
          "_id": "OW80700",
          "ticketRead": false
        }
      }
    },

    // ðŸ”¹ Mes DS non lues en tant que OW80700
    {
      $and: [
        { "readCustomer": false },
        { "claimType.code": { $in: ["DS"] } },
        { "status": { $in: ["NEW", "PROCESSING", "PENDING", "APPROVAL_PENDING", "APPROVAL_REFUSED"] } },
        {
          $or: [
            { "ds.collabTreatmentDone": false },
            {
              $and: [
                { "ds.collabTreatmentDone": true },
                { "readCustomer": false }
              ]
            }
          ]
        },
        {
          $or: [
            { "customer._id": "OW80700" },
            {
              $and: [
                { "customer.eds": true },
                { "customer.edsId": "88200-00501" }
              ]
            }
          ]
        }
      ]
    }
  ]
});
