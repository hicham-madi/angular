private boolean isExpertServiceTreatmentIsLate(Ticket ticket, String userId, String edsId) {
    if (ticket == null || ticket.getClaimType() == null || ticket.getStatus() == null || ticket.getCustomer() == null || ticket.getDs() == null) {
        return false;
    }

    boolean isSameUser =
        userId != null && userId.equals(ticket.getCustomerId()) ||
        (Boolean.TRUE.equals(ticket.getCustomer().isEds()) && edsId != null && edsId.equals(ticket.getCustomer().getEdsId()));

    if (!isSameUser) {
        return false;
    }

    boolean isDS = ClaimTypeCode.DS.getCode().equals(ticket.getClaimType().getCode());

    boolean statusMatch = List.of(
        StatusTicket.NEW,
        StatusTicket.PROCESSING,
        StatusTicket.PENDING,
        StatusTicket.APPROVAL_PENDING,
        StatusTicket.APPROVAL_REFUSED
    ).contains(StatusTicket.valueOf(ticket.getStatus()));

    return isSameUser && isDS && statusMatch && ticket.getDs().isTreatmentIsLate();
}
